{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Alok\\\\Desktop\\\\WEB 3.0\\\\FIND YOUR ROOMMATE\\\\FindYourRoommate\\\\client\\\\src\\\\pages\\\\Dashboard.js\",\n  _s = $RefreshSig$();\nimport TinderCard from 'react-tinder-card';\nimport { useEffect, useState } from 'react';\nimport ChatContainer from '../components/ChatContainer';\nimport { useCookies } from 'react-cookie';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Dashboard = () => {\n  _s();\n  const [user, setUser] = useState(null);\n  const [genderedUsers, setGenderedUsers] = useState(null);\n  const [lastDirection, setLastDirection] = useState();\n  const [cookies, setCookie, removeCookie] = useCookies(['user']);\n  const userId = cookies.UserId;\n  const getUser = async () => {\n    try {\n      const response = await axios.get('http://localhost:8000/user', {\n        params: {\n          userId\n        }\n      });\n      setUser(response.data);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  const getGenderedUsers = async () => {\n    try {\n      // Check if user and gender_interest exist before making the API call\n      if (user !== null && user !== void 0 && user.gender_interest) {\n        const response = await axios.get('http://localhost:8000/gendered-users', {\n          params: {\n            gender: user.gender_interest\n          }\n        });\n        setGenderedUsers(response.data);\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  // Effect 1: Fetch current user data on component mount\n  useEffect(() => {\n    getUser();\n  }, []);\n\n  // Effect 2: Fetch gendered users only after current user data (including gender_interest) is available\n  useEffect(() => {\n    if (user) {\n      getGenderedUsers();\n    }\n  }, [user]); // Reruns when 'user' state changes\n\n  const updateMatches = async matchedUserId => {\n    try {\n      await axios.put('http://localhost:8000/addmatch', {\n        userId,\n        matchedUserId\n      });\n      // Refresh user data to update the matches list\n      getUser();\n    } catch (err) {\n      console.log(err);\n    }\n  };\n  const swiped = (direction, swipedUserId) => {\n    if (direction === 'right') {\n      updateMatches(swipedUserId);\n    }\n    setLastDirection(direction);\n  };\n  const outOfFrame = name => {\n    console.log(name + ' left the screen!');\n  };\n\n  // Calculate filtered list. This will be null/undefined until both user and genderedUsers are fetched.\n  const matchedUserIds = user === null || user === void 0 ? void 0 : user.matches.map(({\n    user_id\n  }) => user_id).concat(userId);\n  const filteredGenderedUsers = genderedUsers === null || genderedUsers === void 0 ? void 0 : genderedUsers.filter(genderedUser => !matchedUserIds.includes(genderedUser.user_id));\n  console.log('filteredGenderedUsers ', filteredGenderedUsers);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [user && filteredGenderedUsers && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"dashboard\",\n      children: [/*#__PURE__*/_jsxDEV(ChatContainer, {\n        user: user\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"swipe-container\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card-container\",\n          children: [filteredGenderedUsers.map(genderedUser => /*#__PURE__*/_jsxDEV(TinderCard, {\n            className: \"swipe\",\n            onSwipe: dir => swiped(dir, genderedUser.user_id),\n            onCardLeftScreen: () => outOfFrame(genderedUser.first_name),\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                backgroundImage: \"url(\" + genderedUser.url + \")\"\n              },\n              className: \"card\",\n              children: /*#__PURE__*/_jsxDEV(\"h3\", {\n                children: genderedUser.first_name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 108,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 105,\n              columnNumber: 33\n            }, this)\n          }, genderedUser.user_id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 29\n          }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"swipe-info\",\n            children: lastDirection ? /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"You swiped \", lastDirection]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 113,\n              columnNumber: 46\n            }, this) : /*#__PURE__*/_jsxDEV(\"p\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 113,\n              columnNumber: 82\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 13\n    }, this), !user && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Loading user profile...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 23\n    }, this)]\n  }, void 0, true);\n};\n_s(Dashboard, \"0bS9CjnLFJex5ipLOoqcdl+vknE=\", false, function () {\n  return [useCookies];\n});\n_c = Dashboard;\nexport default Dashboard;\nvar _c;\n$RefreshReg$(_c, \"Dashboard\");","map":{"version":3,"names":["TinderCard","useEffect","useState","ChatContainer","useCookies","axios","jsxDEV","_jsxDEV","Fragment","_Fragment","Dashboard","_s","user","setUser","genderedUsers","setGenderedUsers","lastDirection","setLastDirection","cookies","setCookie","removeCookie","userId","UserId","getUser","response","get","params","data","error","console","log","getGenderedUsers","gender_interest","gender","updateMatches","matchedUserId","put","err","swiped","direction","swipedUserId","outOfFrame","name","matchedUserIds","matches","map","user_id","concat","filteredGenderedUsers","filter","genderedUser","includes","children","className","fileName","_jsxFileName","lineNumber","columnNumber","onSwipe","dir","onCardLeftScreen","first_name","style","backgroundImage","url","_c","$RefreshReg$"],"sources":["C:/Users/Alok/Desktop/WEB 3.0/FIND YOUR ROOMMATE/FindYourRoommate/client/src/pages/Dashboard.js"],"sourcesContent":["import TinderCard from 'react-tinder-card'\r\nimport {useEffect, useState} from 'react'\r\nimport ChatContainer from '../components/ChatContainer'\r\nimport {useCookies} from 'react-cookie'\r\nimport axios from 'axios'\r\n\r\nconst Dashboard = () => {\r\n    const [user, setUser] = useState(null)\r\n    const [genderedUsers, setGenderedUsers] = useState(null)\r\n    const [lastDirection, setLastDirection] = useState()\r\n    const [cookies, setCookie, removeCookie] = useCookies(['user'])\r\n\r\n    const userId = cookies.UserId\r\n\r\n\r\n    const getUser = async () => {\r\n        try {\r\n            const response = await axios.get('http://localhost:8000/user', {\r\n                params: {userId}\r\n            })\r\n            setUser(response.data)\r\n        } catch (error) {\r\n            console.log(error)\r\n        }\r\n    }\r\n    \r\n    const getGenderedUsers = async () => {\r\n        try {\r\n            // Check if user and gender_interest exist before making the API call\r\n            if (user?.gender_interest) {\r\n                 const response = await axios.get('http://localhost:8000/gendered-users', {\r\n                    params: {gender: user.gender_interest}\r\n                })\r\n                setGenderedUsers(response.data)\r\n            }\r\n        } catch (error) {\r\n            console.log(error)\r\n        }\r\n    }\r\n\r\n    // Effect 1: Fetch current user data on component mount\r\n    useEffect(() => {\r\n        getUser()\r\n    }, [])\r\n\r\n    // Effect 2: Fetch gendered users only after current user data (including gender_interest) is available\r\n    useEffect(() => {\r\n        if (user) {\r\n            getGenderedUsers()\r\n        }\r\n    }, [user]) // Reruns when 'user' state changes\r\n\r\n    const updateMatches = async (matchedUserId) => {\r\n        try {\r\n            await axios.put('http://localhost:8000/addmatch', {\r\n                userId,\r\n                matchedUserId\r\n            })\r\n            // Refresh user data to update the matches list\r\n            getUser() \r\n        } catch (err) {\r\n            console.log(err)\r\n        }\r\n    }\r\n\r\n\r\n    const swiped = (direction, swipedUserId) => {\r\n        if (direction === 'right') {\r\n            updateMatches(swipedUserId)\r\n        }\r\n        setLastDirection(direction)\r\n    }\r\n\r\n    const outOfFrame = (name) => {\r\n        console.log(name + ' left the screen!')\r\n    }\r\n    \r\n    // Calculate filtered list. This will be null/undefined until both user and genderedUsers are fetched.\r\n    const matchedUserIds = user?.matches.map(({user_id}) => user_id).concat(userId)\r\n\r\n    const filteredGenderedUsers = genderedUsers?.filter(genderedUser => !matchedUserIds.includes(genderedUser.user_id))\r\n\r\n\r\n    console.log('filteredGenderedUsers ', filteredGenderedUsers)\r\n    return (\r\n        <>\r\n            {/* FIX: We now check that both 'user' is loaded AND 'filteredGenderedUsers' \r\n            is defined (meaning data fetching for both user and gendered users is complete) \r\n            before attempting to render the complex swipe logic.\r\n            */}\r\n            {user && filteredGenderedUsers &&\r\n            <div className=\"dashboard\">\r\n                <ChatContainer user={user}/>\r\n                \r\n                <div className=\"swipe-container\">\r\n                    <div className=\"card-container\">\r\n\r\n                        {/* Since we checked 'filteredGenderedUsers' above, we can safely map over it here */}\r\n                        {filteredGenderedUsers.map((genderedUser) =>\r\n                            <TinderCard\r\n                                className=\"swipe\"\r\n                                key={genderedUser.user_id}\r\n                                onSwipe={(dir) => swiped(dir, genderedUser.user_id)}\r\n                                onCardLeftScreen={() => outOfFrame(genderedUser.first_name)}>\r\n                                <div\r\n                                    style={{backgroundImage: \"url(\" + genderedUser.url + \")\"}}\r\n                                    className=\"card\">\r\n                                    <h3>{genderedUser.first_name}</h3>\r\n                                </div>\r\n                            </TinderCard>\r\n                        )}\r\n                        <div className=\"swipe-info\">\r\n                            {lastDirection ? <p>You swiped {lastDirection}</p> : <p/>}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>}\r\n            \r\n            {/* Optional: Add a loading state when data is not ready */}\r\n            {!user && <p>Loading user profile...</p>}\r\n        </>\r\n    )\r\n}\r\nexport default Dashboard"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}